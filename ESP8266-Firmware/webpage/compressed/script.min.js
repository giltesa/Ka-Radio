function Karadio(){const q=true,t="Content-type",i="application/x-www-form-urlencoded",B="application/json",f=255,A="http://test.giltesa.com/karadio/php/version.php",l="http://test.giltesa.com/karadio/php/about.php",C="http://test.giltesa.com/karadio/php/yours/index.php",D=window.location.host,r="192.168.1.8";var u,n=false,b,o,m,x;this.translator;this.begin=function(){loadVersionPage();if(m!=0){window.clearInterval(m)}m=window.setInterval(g,1000);a();e();wifi(false);c();refresh();stationDetails()};var s=function(){u=new WebSocket("ws://"+(!q?D:r)+"/");console.log("url:ws://"+(!q?D:r)+"/");u.onmessage=function(I){try{var G=JSON.parse(I.data);console.log("onmessage:"+I.data);if(G.meta){$("#playing").text(G.meta.replace(/\\/g,""))}if(G.wsvol){onRangeVolChange(G.wsvol,false)}if(G.wsicy){j(G.wsicy)}if(G.wssound){d(G.wssound)}if(G.monitor){mPlay(G.monitor)}if(G.wsstation){h(G.wsstation)}}catch(H){console.log("error"+H)}};u.onopen=function(G){console.log("Open, url:ws://"+(!q?D:r)+"/");if(window.timerID){window.clearInterval(window.timerID);window.timerID=0}refresh()};u.onclose=function(G){console.log("onclose code: "+G.code);console.log("onclose reason: "+G.reason);if(!window.timerID){window.timerID=setInterval(function(){e()},2000)}};u.onerror=function(G){console.log("onerror reason: "+G.reason);u.close()}};var e=function(){if(typeof u=="undefined"||u.readyState==u.CLOSED){s()}else{if(u.readyState==u.OPEN){u.send("opencheck")}}};var j=function(G){var H,I=$("#station_details").is(":checked");if(typeof G.auto!="undefined"){$("#aplay").prop("checked",G.auto=="1")}$("#ldescr, #lgenre, #lnot1, #lbitr, #lurl, #icon").addClass("hidden");if(I){if(G.descr){$("#ldescr").removeClass("hidden")}if(G.genre){$("#lgenre").removeClass("hidden")}if((G.not1||G.not2)){$("#lnot1").removeClass("hidden")}if(G.bitr){$("#lbitr").removeClass("hidden")}}$("#curst").text(G.curst.replace(/\\/g,""));$("#name").text(G.name.replace(/\\/g,""));$("#descr").text(G.descr.replace(/\\/g,""));$("#genre").text(G.genre.replace(/\\/g,""));$("#not1").text(G.not1.replace(/\\|^<BR>/g,""));$("#not2").text(G.not2.replace(/\\/g,""));$("#bitr").text(G.bitr.replace(/\\/g,"")+" kB/s");if(G.url1){$("#lurl, #icon").removeClass("hidden");H=G.url1.replace(/\\| /g,"");if(H=="http://www.icecast.org/"){$("#icon").prop("src","/logo.png")}else{$("#icon").prop("src","http://www.google.com/s2/favicons?domain_url="+H)}}H=G.url1.replace(/\\/g,"");$("#url1").text(H);$("#url2").attr("href",H)};var d=function(G){var H;H=E("#treble_range");H.set(G.treb.replace(/\\/g,""));onRangeChange(H,1.5,false,true);H=E("#bass_range");H.set(G.bass.replace(/\\/g,""));onRangeChange(H,1,false,true);H=E("#treblefreq_range");H.set(G.tfreq.replace(/\\/g,""));onRangeChangeFreqTreble(H,1,false,true);H=E("#bassfreq_range");H.set(G.bfreq.replace(/\\/g,""));onRangeChangeFreqBass(H,10,false,true);H=E("#spacial_range");H.set(G.spac.replace(/\\/g,""));onRangeChangeSpatial(H,true);H=E("#vol1_range");H.set(G.vol.replace(/\\/g,""));onRangeVolChange(E("#vol1_range").get(),false)};var h=function(G){$("#stations_select").val((G>=0&&G<f)?G:0)};this.refresh=function(){xhr=new XMLHttpRequest();xhr.onreadystatechange=function(){if(xhr.readyState==4&&xhr.status==200){try{var H=JSON.parse(xhr.responseText);j(H);d(H)}catch(I){console.log("error"+I)}}};try{u.send("monitor");xhr.open("POST",(!q?"icy":"http://"+r+"/icy"),false);xhr.setRequestHeader(t,B);xhr.send()}catch(G){console.log("error"+G)}};var c=function(){xhr=new XMLHttpRequest();xhr.onreadystatechange=function(){if(xhr.readyState==4&&xhr.status==200){var H=JSON.parse(xhr.responseText);$("#aplay").prop("checked",H.rauto=="1")}};try{xhr.open("POST",(!q?"rauto":"http://"+r+"/rauto"),false);xhr.setRequestHeader(t,i);xhr.send("&")}catch(G){console.log("error"+G)}};this.autoPlay=function(){try{xhr.open("POST",(!q?"auto":"http://"+r+"/auto"),false);xhr.setRequestHeader(t,i);xhr.send("id="+$("#aplay").is(":checked")+"&")}catch(G){console.log("error"+G)}};this.selectStation=function(){if($("#aplay").is(":checked")){playStation()}};this.playStation=function(){var G,I;try{z();G=$("#stations_select");I=G.find(":selected").val();localStorage.setItem("selindexstore",I.toString());xhr=new XMLHttpRequest();xhr.open("POST",(!q?"play":"http://"+r+"/play"),false);xhr.setRequestHeader(t,i);xhr.send("id="+I+"&")}catch(H){console.log("error"+H)}};this.stopStation=function(){var G=$("#stations_select");var I=G.find(":selected").val();mStop();localStorage.setItem("selindexstore",I.toString());try{xhr=new XMLHttpRequest();xhr.open("POST",(!q?"stop":"http://"+r+"/stop"),false);xhr.setRequestHeader(t,i);xhr.send()}catch(H){console.log("error"+H)}$("#playing").text("")};this.prevStation=function(){var G=$("#stations_select");var H=G.find(":selected").val();if(H>0){G.selectpicker("val",--H);selectStation()}};this.nextStation=function(){var G=$("#stations_select");var I=G.find(":selected").val();var H=G.find("option").length;if(I<H-1){G.selectpicker("val",++I);selectStation()}};this.stationDetails=function(){var G=$("#station_details").is(":checked");Cookies.set("show_station_details",G,{expires:365});if(!G){$("#ldescr, #lgenre, #lnot1, #lbitr").addClass("hidden")}else{$("#ldescr, #lgenre, #lnot1, #lbitr").removeClass("hidden")}};this.mPlay=function(H){if(H!=null){o=H}else{if(!b){b=!b}}if(b){var G=$("#monitor")[0];G.src=o.endsWith("/")?o+";":o;G.volume=E("#volm_range").get()/100;G.play()}};this.mStop=function(){if(b){b=!b;var G=$("#monitor")[0];G.src="http://karadio.karawin.fr/silence-1sec.mp3";G.pause()}};var z=function(){if(b){$("#monitor")[0].pause()}};this.mVol=function(G){$("#monitor")[0].volume=G};var g=function(){var H=$("#sleep_time");var G=$("#wake_time");$("#time").text(new Date().toLocaleTimeString());if(H.is(":disabled")&&!isNaN(H.val())){if(H.val()>0){H.val(H.val()-1)}else{if(H.val()==0){H.val("");$("#btn_start_sleep, #sleep_time").prop("disabled",false)}}}if(G.is(":disabled")&&!isNaN(G.val())){if(G.val()>0){G.val(G.val()-1)}else{if(G.val()==0){G.val("");$("#btn_start_wake, #wake_time").prop("disabled",false)}}}};this.upTimerSW=function(G,H){if(G.keyCode==13){startTimerSW(H)}};this.startTimerSW=function(K){var M,H,L,G,J,I;if(K=="s"||K=="w"){M=(K=="s"?"sleep":"wake");L=new Date();G=$("#"+M+"_time").val().split(":");J=parseInt(G[0],10);I=parseInt(G[1],10);if(isNaN(J)){y("Error, try again")}else{if(isNaN(I)){H=J}else{fut=new Date(L.getFullYear(),L.getMonth(),L.getDate(),J,I,0);if(fut.getTime()>L.getTime()){H=Math.round((fut.getTime()-L.getTime())/60000)}else{H=1440-Math.round((L.getTime()-fut.getTime())/60000)}if(H==0){H=fut.getTime()>L.getTime()?1:1440}}u.send((K=="s"?"startSleep=":"startWake=")+H+"&");window.setTimeout(function(N){$("#"+M+"_time").val(N);$("#btn_start_"+M+", #"+M+"_time").prop("disabled",true)},2000,(H*60)-2);y(K=="s"?"Started, Good night!":"Started")}}};this.stopTimerSW=function(G){if(G=="s"){u.send("stopSleep");$("#sleep_time").val("");$("#btn_start_sleep, #sleep_time").prop("disabled",false)}else{if(G=="w"){u.send("stopWake");$("#wake_time").val("");$("#btn_start_wake, #wake_time").prop("disabled",false)}}};this.instantPlay=function(){var G;try{xhr=new XMLHttpRequest();xhr.open("POST",(!q?"instant_play":"http://"+r+"/instant_play"),false);xhr.setRequestHeader(t,i);G=$("#instant_path").val();if(!(G.substring(0,1)==="/")){G="/"+G}$("#instant_url").val($("#instant_url").val().replace(/^https?:\/\//,""));G=k(G);xhr.send("url="+$("#instant_url").val()+"&port="+$("#instant_port").val()+"&path="+G+"&")}catch(H){console.log("error"+H)}};this.refreshStations=function(){var G=y("Reloaded the stations... Please Wait",0);window.setTimeout(function(){if(n){stChanged()}localStorage.clear();a();loadStationTable();refresh();G.snackbar("hide")},500)};var a=function(){var H,G=[],K=0;H=$("#stations_select");H.empty();y("Working... Please Wait");function J(M,L){if(L.Name.length>0){G.push($("<option/>").attr({value:M}).text(M+": "+L.Name))}}while(K<f){idstr=K.toString();if(localStorage.getItem(idstr)!=null){try{J(K,JSON.parse(localStorage.getItem(idstr)));K++}catch(I){console.log("error"+I)}}else{try{xhr=new XMLHttpRequest();xhr.onreadystatechange=function(){if(xhr.readyState==4&&xhr.status==200){try{localStorage.setItem(idstr,xhr.responseText);J(K,JSON.parse(xhr.responseText));K++}catch(L){console.log("error"+L)}}};xhr.open("POST",(!q?"getStation":"http://"+r+"/getStation"),false);xhr.setRequestHeader(t,i);xhr.send("idgp="+K+"&")}catch(I){console.log("error"+I)}}}refresh();H.append(G);H.val(parseInt(localStorage.getItem("selindexstore")));H.selectpicker("refresh")};this.loadStationTable=function(){var M=0;var G=$("#stations_table").find("tbody");var J=[];var K;function L(N){return(N.length>116?"Error":N)}function I(O,N){J.push('<tr id="tr'+O+'"><td>'+O+"</td><td>"+L(N.Name)+'</td><td class="hidden-xs">'+L(N.URL)+'</td><td class="hidden-xs">'+L(N.File)+'</td><td class="hidden-xs">'+L(N.Port)+'</td><td class="hidden-xs">'+L(N.ovol)+'</td><td><button type="button" onclick="karadio.editStation('+O+')" onfocus="this.blur()" class="btn btn-default" data-toggle="modal" data-target="#edit_dialog"><i class="material-icons theme">edit</i></button></td></tr>')}for(M;M<f;M++){idstr=M.toString();if(localStorage.getItem(idstr)!=null){try{arr=JSON.parse(localStorage.getItem(idstr))}catch(H){console.log("error"+H)}I(M,arr)}else{try{xhr=new XMLHttpRequest();xhr.onreadystatechange=function(){if(xhr.readyState==4&&xhr.status==200){try{arr=JSON.parse(xhr.responseText)}catch(N){console.log("error"+N)}localStorage.setItem(idstr,xhr.responseText);I(M,arr)}};xhr.open("POST",(!q?"getStation":"http://"+r+"/getStation"),false);xhr.setRequestHeader(t,i);xhr.send("idgp="+M+"&")}catch(H){console.log("error"+H);M--}}}G.empty();G.append(J);setTheme();K=G.find("tr");K.prop("draggable",true);K.on("dragstart",function(N){N.originalEvent.dataTransfer.setData("Text",N.target.id)});K.on("drop",function(N){N.preventDefault();F($("#"+N.originalEvent.dataTransfer.getData("Text"))[0],$("#"+N.currentTarget.id)[0])});K.on("dragover",function(N){N.preventDefault()})};var F=function(I,H){var K=I.parentNode,J=H.nextSibling,G;if(J===I){J=J.nextSibling}K.insertBefore(I,H);for(G=0;G<f;G++){K.rows[G].cells[0].innerText=G.toString();K.rows[G].cells[6].innerHTML=H.parentNode.rows[G].cells[6].innerHTML}$("#stsave").prop("disabled",false);n=true};this.stChanged=function(){if(!n){return}var M,L,K,N,I,H;function G(O){id=H.rows[O].cells[0].innerText;name=H.rows[O].cells[1].innerText;url=H.rows[O].cells[2].innerText;file=H.rows[O].cells[3].innerText;port=H.rows[O].cells[4].innerText;ovol=H.rows[O].cells[5].innerText;localStorage.setItem(id,'{"Name":"'+name+'","URL":"'+url+'","File":"'+file+'","Port":"'+port+'","ovol":"'+ovol+'"}');N=N+"&id="+id+"&url="+url+"&name="+name+"&file="+file+"&port="+port+"&ovol="+ovol+"&"}if(n&&confirm(translator.get("The list is modified. Do you want to save the modified list?"))){M=y("Working... Please Wait",0);H=$("#stations_table").find("tbody")[0];xhr=new XMLHttpRequest();xhr.onreadystatechange=function(){};localStorage.clear();K=7;I=0;try{N="nb="+K;for(L=0;L<K;L++){G(I+L)}xhr.open("POST",(!q?"setStation":"http://"+r+"/setStation"),false);xhr.setRequestHeader(t,i);xhr.send(N)}catch(J){console.log("error "+J)}for(I=K;I<f;I+=(K+1)){try{N="nb="+K;for(L=0;L<K;L++){G(I+L)}xhr.open("POST",(!q?"setStation":"http://"+r+"/setStation"),false);xhr.setRequestHeader(t,i);xhr.send(N)}catch(J){console.log("error "+J)}}M.snackbar("hide");a()}$("#stsave").prop("disabled",true);n=false;refresh()};this.editStation=function(J){var G;function I(K){$("#edit_url").val(K.URL);$("#edit_name").val(K.Name);$("#edit_path").val(K.File);if(K.Port=="0"){K.Port="80"}$("#edit_port").val(K.Port);if(K.URL){$("#edit_furl").val("http://"+K.URL+":"+K.Port+K.File)}else{$("#edit_furl").val("")}E("#edit_ovol").set(K.ovol)}$("#edit_slot").text(J);idstr=J.toString();if(localStorage.getItem(idstr)!=null){try{G=JSON.parse(localStorage.getItem(idstr))}catch(H){console.log("error"+H)}I(G)}else{xhr=new XMLHttpRequest();xhr.onreadystatechange=function(){if(xhr.readyState==4&&xhr.status==200){try{G=JSON.parse(xhr.responseText)}catch(K){console.log("error"+K)}I(G)}};xhr.open("POST",(!q?"getStation":"http://"+r+"/getStation"),false);xhr.setRequestHeader(t,i);xhr.send("idgp="+J+"&")}};this.saveStation=function(){var N=$("#edit_slot").text(),K=$("#edit_name").val(),J=$("#edit_url").val().replace(/^https?:\/\//,""),M=$("#edit_path").val(),I=$("#edit_port").val(),G=parseInt(E("#edit_ovol").get()),H;if(!(M.substring(0,1)==="/")){M="/"+M}H=k(M);console.log("Path: "+M);console.log("JSON: "+H);try{xhr=new XMLHttpRequest();xhr.open("POST",(!q?"setStation":"http://"+r+"/setStation"),false);xhr.setRequestHeader(t,i);xhr.send("nb="+1+"&id="+N+"&url="+J+"&name="+K+"&file="+H+"&ovol="+G+"&port="+I+"&&");localStorage.setItem(N,'{"Name":"'+K+'","URL":"'+J+'","File":"'+M+'","Port":"'+I+'","ovol":"'+G+'"}')}catch(L){console.log("error save "+L)}a();loadStationTable()};this.clearStations=function(){var I=translator.get("Warning: This will clear all stations."),H=translator.get("Be sure to save station before."),G=translator.get("Clear now?");if(!confirm(I+"\n"+H+"\n\n"+G)){refresh()}else{xhr=new XMLHttpRequest();xhr.open("POST",(!q?"clear":"http://"+r+"/clear"),false);xhr.setRequestHeader(t,i);xhr.send();refreshStations()}};this.printStationList=function(){var I,G,H;H=$("#stations_table").clone();$(H).find("tr").find("th:eq(6), td:eq(6)").remove();$(H).find("tr").find("td:eq(1)").each(function(){if($(this).text().trim()==""){$(this).parent().remove()}});G="<html>";G+="<h1>"+translator.get("Karadio Stations list")+"</h1><hr><br/>";G+=H[0].outerHTML;G+="</html>";I=window.open("");I.document.write(G);I.print();I.close()};this.resetEQ=function(){var G;G=E("#treble_range");G.set(0);onRangeChange(G,1.5,false);G=E("#bass_range");G.set(0);onRangeChange(G,1,false);G=E("#treblefreq_range");G.set(1);onRangeChangeFreqTreble(G,1,false);G=E("#bassfreq_range");G.set(2);onRangeChangeFreqBass(G,10,false);G=E("#spacial_range");G.set(0);onRangeChangeSpatial(G)};this.onRangeChange=function(L,K,H,G){var I="#"+L.target.id.replace("range","span");var J=parseInt(L.get());if(H){J=L.options.range.max-J}$(I).text((J*K)+" dB");if(typeof(G)=="undefined"){v()}};this.onRangeChangeFreqTreble=function(L,K,H,G){var I="#"+L.target.id.replace("range","span");var J=parseInt(L.get());if(H){J=L.options.range.max-J}$(I).text((J*K)+" kHz");if(typeof(G)=="undefined"){v()}};this.onRangeChangeFreqBass=function(L,K,H,G){var I="#"+L.target.id.replace("range","span");var J=parseInt(L.get());if(H){J=L.options.range.max-J}$(I).text((J*K)+" Hz");if(typeof(G)=="undefined"){v()}};this.onRangeChangeSpatial=function(K,H){var I="#"+K.target.id.replace("range","span");var J=parseInt(K.get());var G;switch(J){case 0:G=translator.get("Off");break;case 1:G=translator.get("Minimal");break;case 2:G=translator.get("Normal");break;case 3:G=translator.get("Maximal");break}$(I).text(G);if(typeof(H)=="undefined"){v()}};this.onRangeVolChange=function(I,H){var G=w(I);E("#vol1_range").set(I);$("#vol1_span").text(parseInt(G*-0.5)+" dB");E("#vol2_range").set(I);$("#vol2_span").text(parseInt(G*-0.5)+" dB");if(H&&u.readyState==u.OPEN){u.send("wsvol="+I+"&")}};var w=function(H){var G=Number(H)+1;var I=Math.round((Math.log10(255/G)*105.54571334));return I};var v=function(){xhr=new XMLHttpRequest();xhr.open("POST",(!q?"sound":"http://"+r+"/sound"),false);xhr.setRequestHeader(t,i);xhr.send("&bass="+parseInt(E("#bass_range").get())+"&treble="+parseInt(E("#treble_range").get())+"&bassfreq="+parseInt(E("#bassfreq_range").get())+"&treblefreq="+parseInt(E("#treblefreq_range").get())+"&spacial="+parseInt(E("#spacial_range").get())+"&")};this.backupStations=function(){var K,H="",J,G;K=$("#backup-name").val();if(K==""){K="WebStations.txt"}for(var I=0;I<f;I++){H+=localStorage[I]+"\n"}J=new Blob([H],{type:"text/plain"}),G=document.createElement("a");G.style.display="none";G.setAttribute("download",K);document.body.appendChild(G);if(window.navigator.msSaveOrOpenBlob){G.addEventListener("click",function(){window.navigator.msSaveBlob(J,K)})}else{if("URL" in window){G.href=window.URL.createObjectURL(J)}else{G.href=window.webkitURL.createObjectURL(J)}}G.click()};this.restoreStations=function(){var L,K,N,G,I,H,J,M;if(window.File&&window.FileReader&&window.FileList&&window.Blob){G=new FileReader();xhr=new XMLHttpRequest();G.onload=function(Q){function O(S,R){if(!R.ovol){R.ovol="0"}N+="&id="+S+"&url="+R.URL+"&name="+R.Name+"&file="+R.File+"&port="+R.Port+"&ovol="+R.ovol+"&";localStorage.setItem(S,'{"Name":"'+R.Name+'","URL":"'+R.URL+'","File":"'+R.File+'","Port":"'+R.Port+'","ovol":"'+R.ovol+'"}')}I=this.result.split("\n");localStorage.clear();K=3;H=0;try{N="nb="+K;for(L=0;L<K;L++){O(L,JSON.parse(I[L]))}xhr.open("POST",(!q?"setStation":"http://"+r+"/setStation"),false);xhr.setRequestHeader(t,i);console.log("post "+N);xhr.send(N)}catch(P){console.log("error "+P)}for(H=K;H<I.length;H+=(K-1)){try{N="nb="+K;for(L=0;L<K;L++){O(H+L,JSON.parse(I[H+L]))}xhr.open("POST",(!q?"setStation":"http://"+r+"/setStation"),false);xhr.setRequestHeader(t,i);xhr.send(N)}catch(P){console.log("error "+P)}}M.snackbar("hide");a()};J=$("#restore-file")[0].files[0];if(J==null){y("Please select a file")}else{M=y("Working... Please Wait",0);window.setTimeout(function(){G.readAsText(J)},1000)}}};this.wifi=function(G){if(G){var H=y("System reboot... Please Wait",0);window.setTimeout(function(){H.snackbar("hide");window.setTimeout(function(){window.location.href="http://"+$("#ip").val()+"/"},2000)},16000)}xhr=new XMLHttpRequest();xhr.onreadystatechange=function(){if(xhr.readyState==4&&xhr.status==200){var I=JSON.parse(xhr.responseText);$("#ssid").val(I.ssid);$("#passwd").val(I.pasw);$("#ssid2").val(I.ssid2);$("#passwd2").val(I.pasw2);$("#mac").text(I.mac);$("#dhcp").prop("checked",I.dhcp=="1");$("#ip").val(I.ip);$("#mask").val(I.msk);$("#gw").val(I.gw);$("#ip, #mask, #gw").prop("disabled",$("#dhcp").is(":checked"));$("#ua").val(I.ua)}};xhr.open("POST",(!q?"wifi":"http://"+r+"/wifi"),false);xhr.setRequestHeader(t,i);xhr.send("valid="+(G?1:0)+"&ssid="+encodeURIComponent($("#ssid").val())+"&pasw="+encodeURIComponent($("#passwd").val())+"&ssid2="+encodeURIComponent($("#ssid2").val())+"&pasw2="+encodeURIComponent($("#passwd2").val())+"&ip="+$("#ip").val()+"&msk="+$("#mask").val()+"&gw="+$("#gw").val()+"&ua="+encodeURIComponent($("#ua").val())+"&dhcp="+$("#dhcp").is(":checked")+"&")};this.clickDHCP=function(){$("#ip, #mask, #gw").prop("disabled",$("#dhcp").is(":checked"))};this.upgradeFirmware=function(){if(u.readyState==u.OPEN){var G=y("Updating the firmware, please wait...",0);basket.clear();u.send("upgrade");window.setTimeout(function(){G.snackbar("hide");window.setTimeout(function(){window.location.reload(true)},2000)},30000)}};var k=function(G){return G.replace(/[&]/g,function(H){return"%"+H.charCodeAt(0).toString(16)})};this.parseURL=function(H){if(H.ctrlKey||H.keyCode==17){return}var I,G;I=H.target.id;I=I.slice(0,I.indexOf("_"));G=document.createElement("a");G.href=$("#"+I+"_furl").val();if(G.hostname==location.hostname){$("#"+I+"_furl").val("http://"+$("#"+I+"_furl").val().replace(/^http:\/\//,""));G.href=$("#"+I+"_furl").val()}$("#"+I+"_url").val(G.hostname);$("#"+I+"_port").val(G.port==""?"80":G.port);$("#"+I+"_path").val(G.pathname+G.search+G.hash)};var p=function(I,G){if(window.XDomainRequest){xhr=new XDomainRequest()}else{if(window.XMLHttpRequest){xhr=new XMLHttpRequest()}}xhr.onload=function(){I.html((/<body[^>]*>((.|[\n\r])*)<\/body>/im).exec(xhr.responseText)[1])};xhr.open("GET",G,false);try{xhr.send(null)}catch(H){}};this.loadVersionPage=function(){p($("#version_container"),A);translator.lang(Cookies.get("language"));var H=$("#firmware_last").text().split(".").join("");var G=$("#firmware_installed").text().split(".").join("");if(parseInt(G)<parseInt(H)){$("#firmware_last").parent().addClass("label-danger").removeClass("label-success");if(Cookies.get("show_toast_updates")==="true"&&!Cookies.get("hide_toast_firmware_"+H)){var I=translator.get("New firmware %1 available!").replace("%1",$("#firmware_last").text());var J='<div class="row"><div class="pull-left"><i class="material-icons">memory</i> '+I+'</div><div class="pull-right"><i class="material-icons">clear</i></div></div>';window.setTimeout(function(){$.snackbar({content:J,style:"deeppurple",timeout:0,htmlAllowed:true,onClose:function(){Cookies.set("hide_toast_firmware_"+H,true,{expires:7})}})},2000)}}};this.loadAboutPage=function(){p($("#about_container"),l);translator.lang(Cookies.get("language"));$("button").focus(function(){var G=this;window.setTimeout(function(){G.blur()},100)});$("#yours_button").one("click",function(G){p($("#yours_dialog").find(".modal-body"),C);translator.lang(Cookies.get("language"));setTheme()})};var E=function(G){return $(G).get(0).noUiSlider};var y=function(G,I){var J='<div class="row wait"><div class="pull-left">'+translator.get(G)+'</div><div class="pull-right"><svg class="spinner" width="24px" height="20px" viewBox="0 0 66 66" xmlns="http://www.w3.org/2000/svg"><circle class="path" fill="none" stroke-width="6" stroke-linecap="round" cx="33" cy="33" r="30"></circle></svg></div></div>';var H=$.snackbar({content:J,style:"deeppurple",timeout:(I==undefined?3000:I),htmlAllowed:true});H.snackbar("show");return H};this.setTheme=function(I,G){var H=(G!==undefined?G:Cookies.get("theme"));if(I!==undefined){I.selectpicker("setStyle","btn-primary btn-success btn-info btn-warning btn-danger btn-inverse","remove");I.selectpicker("setStyle","btn-"+H,"add");I.selectpicker("refresh")}$("button.theme").removeClass("btn-primary btn-success btn-info btn-warning btn-danger btn-inverse").addClass("btn-"+H);$("nav.theme").removeClass("navbar-primary navbar-success navbar-info navbar-warning navbar-danger navbar-inverse").addClass("navbar-"+H);$(".togglebutton.theme").removeClass("tb-primary tb-success tb-info tb-warning tb-danger tb-inverse").addClass("tb-"+H);$(".slider.theme").removeClass("sl-primary sl-success sl-info sl-warning sl-danger sl-inverse").addClass("sl-"+H);$(".checkbox.theme").removeClass("cb-primary cb-success cb-info cb-warning cb-danger cb-inverse").addClass("cb-"+H);$(".material-icons.theme").css("color",$("#theme_"+H).css("background-color"));$("a.theme").css("color",$("#theme_"+H).css("background-color"))};return this}var karadio=Karadio();$(document).ready(function(k){$.material.init();window.scrollTo(0,0);$("#home, #stations, #settings, #about, .lang-selector").click(function(l){if($(".navbar-collapse").is(":visible")&&$(".navbar-toggle").is(":visible")){$(".navbar-collapse").collapse("toggle")}});$("#home, #stations, #settings, #about").click(function(l){window.scrollTo(0,0);karadio.stChanged()});$("#home").click(function(l){karadio.refresh()});$("#stations").click(function(l){karadio.loadStationTable()});$("#settings").click(function(l){karadio.wifi(false)});$("#about").one("click",function(l){karadio.loadAboutPage();karadio.setTheme()});$("button").focus(function(){var l=this;window.setTimeout(function(){l.blur()},100)});$(".tooltips[data-toggle='tooltip']").tooltip();if(Cookies.get("show_station_details")===undefined){Cookies.set("show_station_details",true,{expires:365})}$("#station_details").prop("checked",Cookies.get("show_station_details")==="true");if(Cookies.get("show_toast_updates")===undefined){Cookies.set("show_toast_updates",true,{expires:365})}$("#show_toast_updates").prop("checked",Cookies.get("show_toast_updates")==="true");$("#show_toast_updates").click(function(l){Cookies.set("show_toast_updates",$(this).is(":checked"),{expires:365});Cookies.remove("hide_toast_firmware_"+$("#firmware_last").text().split(".").join(""))});var j=$("#vol1_range").get(0);noUiSlider.create(j,{start:[0],connect:[true,false],step:1,range:{min:0,max:254}});j.noUiSlider.on("change",function(){karadio.onRangeVolChange(this.get(),true)});var i=$("#vol2_range").get(0);noUiSlider.create(i,{start:[0],connect:[true,false],step:1,range:{min:0,max:254}});i.noUiSlider.on("change",function(){karadio.onRangeVolChange(this.get(),true)});var h=$("#volm_range").get(0);noUiSlider.create(h,{start:[50],connect:[true,false],step:1,range:{min:0,max:100}});h.noUiSlider.on("change",function(){karadio.mVol(this.get()/this.options.range.max)});var g=$("#edit_ovol").get(0);noUiSlider.create(g,{start:[-126],connect:[true,false],step:2,range:{min:-126,max:126}});var f=$("#treble_range").get(0);noUiSlider.create(f,{start:[-8],connect:[true,false],step:1,range:{min:-8,max:7}});f.noUiSlider.on("change",function(){karadio.onRangeChange(this,1.5,false)});var e=$("#treblefreq_range").get(0);noUiSlider.create(e,{start:[0],connect:[true,false],step:1,range:{min:1,max:15}});e.noUiSlider.on("change",function(){karadio.onRangeChangeFreqTreble(this,1,false)});var d=$("#bass_range").get(0);noUiSlider.create(d,{start:[0],connect:[true,false],step:1,range:{min:0,max:15}});d.noUiSlider.on("change",function(){karadio.onRangeChange(this,1,false)});var c=$("#bassfreq_range").get(0);noUiSlider.create(c,{start:[2],connect:[true,false],step:1,range:{min:2,max:15}});c.noUiSlider.on("change",function(){karadio.onRangeChangeFreqBass(this,10,false)});var b=$("#spacial_range").get(0);noUiSlider.create(b,{start:[0],connect:[true,false],step:1,range:{min:0,max:3}});b.noUiSlider.on("change",function(){karadio.onRangeChangeSpatial(this)});var a=$("#theme_select");a.find("option").each(function(){$(this).css("color",$("#theme_"+this.value).css("background-color"))});if(Cookies.get("theme")===undefined){a.selectpicker("setStyle","btn-inverse","add");a.selectpicker("val","inverse");Cookies.set("theme","inverse",{expires:365})}else{a.selectpicker("val",Cookies.get("theme"));karadio.setTheme(a,Cookies.get("theme"))}a.selectpicker("refresh");a.on("shown.bs.select",function(l){Cookies.set("theme",this.value,{expires:365})});a.change(function(l){karadio.setTheme($(this),this.value);Cookies.set("theme",this.value,{expires:365})});karadio.translator=$("body").translate({lang:Cookies.get("language"),t:translations});$(".lang-selector").click(function(l){var m=$(this).attr("data-value");Cookies.set("language",m,{expires:365});karadio.translator.lang(m);l.preventDefault()});karadio.begin()});